<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿¡ä»°ä¸ç†æ€§æµ‹éªŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 600px;
            width: 100%;
            padding: 40px;
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 28px;
        }
        
        h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
        }
        
        .progress {
            background: #e0e0e0;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .question {
            font-size: 18px;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        
        .options {
            display: grid;
            gap: 12px;
        }
        
        .option-btn {
            background: #f5f5f5;
            border: 2px solid #e0e0e0;
            padding: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 16px;
            text-align: left;
            color: #333;
        }
        
        .option-btn:hover {
            background: #667eea;
            border-color: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }
        
        .result {
            text-align: center;
        }
        
        .result h2 {
            color: #667eea;
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        .analysis {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-size: 18px;
            line-height: 1.8;
            color: #333;
        }
        
        .scores {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }
        
        .score-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .score-label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .score-value {
            font-size: 32px;
            font-weight: bold;
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 16px 40px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 20px;
        }
        
        .restart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        @media (max-width: 480px) {
            .container {
                padding: 24px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .question {
                font-size: 16px;
            }
            
            .option-btn {
                padding: 14px;
                font-size: 15px;
            }
            
            .scores {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <h1>ä¿¡ä»°ä¸ç†æ€§æµ‹éªŒ</h1>
        <div id="content"></div>
    </div>

    <script>
        const questions = [
            { q: "å¦‚æœæœ‰äººè¯´ï¼šæ‹œä¸‰æ‹œï¼Œè´¢ç¥å°±ä¼šçœ·é¡¾ä½ ã€‚ä½ çš„ç¬¬ä¸€æ„Ÿè§‰æ˜¯ï¼Ÿ", options: ["çœŸæœ‰é“ç†", "ä¸å¦¨ä¸€è¯•", "è¯´è¯´è€Œå·²", "å®Œå…¨ä¸ä¿¡"] },
            { q: "è¿‡å¹´æ—¶äº²å‹æ‹‰ä½ å»æ‹œè´¢ç¥ï¼Œä½ ä¼šï¼š", options: ["å¼€å¿ƒå‚ä¸", "ç¤¼è²Œè·Ÿéš", "è¡¨ç¤ºä¸éœ€è¦", "æ˜ç¡®æ‹’ç»"] },
            { q: "å¦‚æœä½ ä¸­å½©ç¥¨ï¼Œä½ ä¼šè§‰å¾—æ˜¯ï¼š", options: ["ç¥æ˜åº‡ä½‘", "è¿æ°”", "æŠ•èµ„æ™ºæ…§", "å‘½ä¸­æ³¨å®š"] },
            { q: "ä½ æ˜¯å¦ç›¸ä¿¡'å¿ƒè¯šåˆ™çµ'ï¼Ÿ", options: ["ç»å¯¹ç›¸ä¿¡", "æœ‰ç‚¹ç›¸ä¿¡", "çœ‹æƒ…å†µ", "ä¸ä¿¡"] },
            { q: "åœ¨ä½ çœ‹æ¥ï¼Œè´¢å¯Œçš„è·å¾—æ›´æ¥è¿‘ï¼š", options: ["ç¥æ˜åº‡ä½‘", "å‘½è¿å®‰æ’", "è‡ªå·±åŠªåŠ›", "ç¤¾ä¼šå…³ç³»"] },
            { q: "é¢å¯¹äººç”Ÿå›°å¢ƒï¼Œä½ æ›´å¸¸æ±‚åŠ©ï¼š", options: ["å®—æ•™ä»ªå¼", "å®¶äººæœ‹å‹", "ä¸“ä¸šé¡¾é—®", "è‡ªæˆ‘åæ€"] },
            { q: "ä½ å¬åˆ°'æ‹œä¸‰æ‹œ'ï¼Œæœ€å…ˆè”æƒ³åˆ°ï¼š", options: ["åº™ä¼š/å¯ºåº™", "å©šç¤¼/ä¼ ç»Ÿä»ªå¼", "å®¶åº­ç¥­ç¥–", "å½¢å¼ä¸»ä¹‰"] },
            { q: "ä½ æ›´å®¹æ˜“æ¥å—çš„ç¥ç¦è¯­æ˜¯ï¼š", options: ["é˜¿å¼¥é™€ä½›", "æ„¿ä¸»ä¿ä½‘ä½ ", "ä¸Šå¸ç¥ç¦ä½ ", "ç¥ä½ æˆåŠŸ"] },
            { q: "ä½ è§‰å¾—'å‘½è¿'æ˜¯å¦å­˜åœ¨ï¼Ÿ", options: ["å®Œå…¨å­˜åœ¨", "éƒ¨åˆ†å­˜åœ¨", "å¤§éƒ¨åˆ†é äºº", "ä¸å­˜åœ¨"] },
            { q: "ä½ å¯¹é£æ°´çš„æ€åº¦ï¼š", options: ["åšä¿¡", "æœ‰å‚è€ƒä»·å€¼", "æ— æ‰€è°“", "å®Œå…¨æ‹’ç»"] },
            { q: "ä½ æ›´å€¾å‘çš„ä»·å€¼è§‚ï¼š", options: ["ä½›ï¼šå› ç¼˜æœæŠ¥", "é“ï¼šæ— ä¸ºé¡ºå…¶è‡ªç„¶", "å„’ï¼šä¿®èº«é½å®¶æ²»å›½", "ç°ä»£ï¼šè‡ªæˆ‘å®ç°"] },
            { q: "å¦‚æœæœ‰äººè¯·ä½ å‚åŠ å®—æ•™æ´»åŠ¨ï¼Œä½ ä¼šï¼š", options: ["å¾ˆä¹æ„", "çœ‹æƒ…å†µ", "ç¤¼è²Œæ‹’ç»", "æ˜ç¡®æ‹’ç»"] },
            { q: "ä½ å¯¹ç¥­ç¥–ä¹ ä¿—çš„æ€åº¦ï¼š", options: ["å¿…é¡»ä¼ æ‰¿", "ä¿æŒä½†ç®€åŒ–", "çœ‹çˆ¶æ¯æ˜¯å¦éœ€è¦", "æ²¡å¿…è¦"] },
            { q: "å½“ä½ å¬åˆ°'è™”è¯š'ä¸€è¯ï¼Œä½ çš„è”æƒ³æ˜¯ï¼š", options: ["å®—æ•™ä¿¡ä»°", "äººçš„çœŸå¿ƒ", "ç›²ç›®ä¿¡ä»°", "ä¼ ç»Ÿä»ªå¼"] },
            { q: "æŠ•èµ„å‰ä½ ä¼šæ›´ä¾èµ–ï¼š", options: ["å åœ/æ±‚ç­¾", "ä»–äººå»ºè®®", "è‡ªå·±åˆ†æ", "éšæœºé€‰æ‹©"] },
            { q: "å¦‚æœé’±åŒ…é‡Œå¤šæ”¾ä¸€å¼ 'æŠ¤èº«ç¬¦'ï¼Œä½ ä¼šè§‰å¾—ï¼š", options: ["èƒ½ä¿è´¢è¿", "å¿ƒç†å®‰æ…°", "è£…é¥°å“", "å¤šä½™"] },
            { q: "ä½ æ›´å¸¸ç”¨çš„å†³ç­–æ–¹å¼æ˜¯ï¼š", options: ["å‡­ç›´è§‰", "å¬å–æ„è§", "é€»è¾‘æ¨ç†", "éšæœºåº”å˜"] },
            { q: "å¦‚æœåŒ»ç”Ÿå’Œé«˜åƒ§ç»™å‡ºä¸åŒçš„å¥åº·å»ºè®®ï¼Œä½ å€¾å‘ï¼š", options: ["é«˜åƒ§", "ä¸¤è€…ç»“åˆ", "åŒ»ç”Ÿ", "è‡ªå·±åˆ¤æ–­"] },
            { q: "ä½ ç›¸ä¿¡'ç§‘å­¦ä¸å®—æ•™å¯ä»¥å¹¶å­˜'å—ï¼Ÿ", options: ["ç»å¯¹å¯ä»¥", "æœ‰äº›å†²çª", "éš¾ä»¥è°ƒå’Œ", "å®Œå…¨å¯¹ç«‹"] },
            { q: "ä½ è§‰å¾—'åŠªåŠ›å’Œå¥½è¿'çš„å…³ç³»æ˜¯ï¼š", options: ["è¿æ°”å¤§äºåŠªåŠ›", "åŠªåŠ›å’Œè¿æ°”å„åŠ", "åŠªåŠ›å¤§äºè¿æ°”", "å…¨é è‡ªå·±"] },
            { q: "ä½ æ›´å–œæ¬¢çš„è§£é‡Šæ–¹å¼ï¼š", options: ["ç¥ç§˜æ•…äº‹", "å“²å­¦å¯“è¨€", "ç§‘å­¦é€»è¾‘", "å¹½é»˜è®½åˆº"] },
            { q: "å¦‚æœæœ‰äººè¯´'ä½ å‘è´¢äº†æ˜¯å› ä¸ºä¸‰æ‹œ'ï¼Œä½ ä¼šï¼š", options: ["è®¤åŒ", "ç¬‘ç¬‘", "åé©³", "æ²¡å…´è¶£"] },
            { q: "ä½ è§‰å¾—'è´¢å¯Œ'çš„æœ€ç»ˆæ„ä¹‰æ˜¯ï¼š", options: ["æ»¡è¶³ç”Ÿæ´»", "è¡Œå–„åŠ©äºº", "è¯æ˜ä»·å€¼", "è‡ªæˆ‘äº«ä¹"] },
            { q: "ä½ å¯¹'æ‹œä¸‰æ‹œ'çš„æ½œæ„è¯†æ„Ÿå—ï¼š", options: ["å®‰å…¨æ„Ÿ", "ä¼ ç»Ÿä¹ ä¿—", "æ— æ‰€è°“", "ä¸èˆ’æœ"] },
            { q: "ä½ æ›´æ„¿æ„ç›¸ä¿¡å“ªç§æ•…äº‹ï¼š", options: ["ä½›ç¥–æ˜¾çµ", "é“å£«ç¬¦å’’", "ç§‘å­¦çªç ´", "äººç”Ÿä¼ å¥‡"] },
            { q: "å¦‚æœé‡åˆ°ä¸å…¬å¹³ï¼Œä½ ä¼šï¼š", options: ["æ¥å—å‘½è¿", "æ±‚ç¥åº‡ä½‘", "æ®ç†åŠ›äº‰", "çœ‹ç¼˜åˆ†"] },
            { q: "ä½ å¯¹'è¿·ä¿¡'è¿™ä¸ªè¯çš„æ„Ÿè§‰ï¼š", options: ["è´Ÿé¢", "ä¸­æ€§", "æ­£é¢", "çœ‹è¯­å¢ƒ"] },
            { q: "å½“åˆ«äººè¯´'æ‹œä¸‰æ‹œèƒ½å‘è´¢'æ—¶ï¼Œä½ ä¼šï¼š", options: ["æœ‰ç‚¹ç¾¡æ…•", "å¥½å¥‡", "å˜²ç¬‘", "å†·æ¼ "] },
            { q: "ä½ æ›´æ„¿æ„æˆä¸ºçš„äººï¼š", options: ["ä¿¡ä»°åšå®šçš„äºº", "ç†æ€§æ™ºæ…§çš„äºº", "ä¸–æ•…åœ†æ»‘çš„äºº", "è‡ªç”±æ´’è„±çš„äºº"] },
            { q: "å¦‚æœæœ€åå‘Šè¯‰ä½ ï¼šä½ å…¶å®æ¯”è‡ªå·±æƒ³è±¡çš„æ›´'è™”è¯š/æ›´ç†æ™º'ï¼Œä½ ä¼šï¼š", options: ["æ¥å—", "åŠä¿¡åŠç–‘", "è´¨ç–‘", "ä¸åœ¨ä¹"] }
        ];

        let currentQuestion = 0;
        let answers = [];

        function renderQuestion() {
            const progress = ((currentQuestion / questions.length) * 100).toFixed(0);
            const content = document.getElementById('content');
            
            content.innerHTML = `
                <h2>é—®é¢˜ ${currentQuestion + 1} / ${questions.length}</h2>
                <div class="progress">
                    <div class="progress-bar" style="width: ${progress}%"></div>
                </div>
                <div class="question">${questions[currentQuestion].q}</div>
                <div class="options">
                    ${questions[currentQuestion].options.map((opt, i) => 
                        `<button class="option-btn" onclick="handleAnswer('${opt}')">${opt}</button>`
                    ).join('')}
                </div>
            `;
        }

        function handleAnswer(option) {
            answers[currentQuestion] = option;
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
            } else {
                calculateResult();
            }
        }

        function calculateResult() {
            let scores = { faith: 0, reason: 0, mixed: 0, fate: 0 };
            
            const faithAnswers = ["çœŸæœ‰é“ç†","å¼€å¿ƒå‚ä¸","ç¥æ˜åº‡ä½‘","ç»å¯¹ç›¸ä¿¡","åº™ä¼š/å¯ºåº™","é˜¿å¼¥é™€ä½›","åšä¿¡","ä½›ï¼šå› ç¼˜æœæŠ¥","å¾ˆä¹æ„","å¿…é¡»ä¼ æ‰¿","å®—æ•™ä¿¡ä»°","å åœ/æ±‚ç­¾","èƒ½ä¿è´¢è¿","é«˜åƒ§","è¿æ°”å¤§äºåŠªåŠ›","ç¥ç§˜æ•…äº‹","è®¤åŒ","ä½›ç¥–æ˜¾çµ","æ±‚ç¥åº‡ä½‘"];
            const mixedAnswers = ["ä¸å¦¨ä¸€è¯•","ç¤¼è²Œè·Ÿéš","æœ‰ç‚¹ç›¸ä¿¡","éƒ¨åˆ†å­˜åœ¨","æœ‰å‚è€ƒä»·å€¼","é“ï¼šæ— ä¸ºé¡ºå…¶è‡ªç„¶","çœ‹æƒ…å†µ","ä¿æŒä½†ç®€åŒ–","äººçš„çœŸå¿ƒ","ä»–äººå»ºè®®","å¿ƒç†å®‰æ…°","å¬å–æ„è§","ä¸¤è€…ç»“åˆ","åŠªåŠ›å’Œè¿æ°”å„åŠ","å“²å­¦å¯“è¨€","ç¬‘ç¬‘","é“å£«ç¬¦å’’","çœ‹ç¼˜åˆ†","ä¸­æ€§","å¥½å¥‡","åŠä¿¡åŠç–‘"];
            const reasonAnswers = ["è¯´è¯´è€Œå·²","ä¸ä¿¡","è‡ªå·±åŠªåŠ›","ä¸“ä¸šé¡¾é—®","å¤§éƒ¨åˆ†é äºº","æ— æ‰€è°“","å„’ï¼šä¿®èº«é½å®¶æ²»å›½","ç¤¼è²Œæ‹’ç»","çœ‹çˆ¶æ¯æ˜¯å¦éœ€è¦","é€»è¾‘æ¨ç†","åŒ»ç”Ÿ","ç§‘å­¦é€»è¾‘","åé©³","è¯æ˜ä»·å€¼","ç§‘å­¦çªç ´","æ®ç†åŠ›äº‰","è´Ÿé¢","å˜²ç¬‘","ç†æ€§æ™ºæ…§çš„äºº","è´¨ç–‘"];
            
            answers.forEach(answer => {
                if (faithAnswers.includes(answer)) {
                    scores.faith++;
                } else if (mixedAnswers.includes(answer)) {
                    scores.mixed++;
                } else if (reasonAnswers.includes(answer)) {
                    scores.reason++;
                } else {
                    scores.fate++;
                }
            });

            const sortedScores = Object.entries(scores).sort((a, b) => b[1] - a[1]);
            const dominant = sortedScores[0][0];

            let analysis = "";
            let analysisType = "";
            if (dominant === "faith") {
                analysisType = "ä¿¡ä»°å‹";
                analysis = "ä½ å€¾å‘<strong>ä¿¡ä»°å‹</strong>ï¼šå¯¹å®—æ•™ä¸ä¼ ç»Ÿæ–‡åŒ–æœ‰æ·±åšè®¤åŒï¼Œå®¹æ˜“åœ¨ä»ªå¼ä¸­æ‰¾åˆ°å®‰å…¨æ„Ÿã€‚";
            } else if (dominant === "reason") {
                analysisType = "ç†æ™ºå‹";
                analysis = "ä½ å€¾å‘<strong>ç†æ™ºå‹</strong>ï¼šæ›´ä¾èµ–é€»è¾‘ä¸å®è·µï¼Œé‡è§†ç§‘å­¦å’Œè‡ªæˆ‘åˆ¤æ–­ã€‚";
            } else if (dominant === "mixed") {
                analysisType = "æŠ˜è¡·å‹";
                analysis = "ä½ å€¾å‘<strong>æŠ˜è¡·å‹</strong>ï¼šä¿¡ä»°ä¸ç†æ™ºå…¼é¡¾ï¼Œæ—¢å°Šé‡ä¼ ç»Ÿï¼Œä¹Ÿé‡è§†ç°å®ã€‚";
            } else {
                analysisType = "å®¿å‘½å‹";
                analysis = "ä½ å€¾å‘<strong>å®¿å‘½å‹</strong>ï¼šæ›´éšç¼˜é¡ºåŠ¿ï¼Œå®¹æ˜“æ¥å—å‘½è¿å®‰æ’ã€‚";
            }

            // Send results to Google Sheets
            sendToGoogleSheets(scores, analysisType);

            renderResult(scores, analysis);
        }

        async function sendToGoogleSheets(scores, resultType) {
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxFcxcKKOKOtpL-WhbzqP0E1anpvQU7PBhBGRHVaRf0Ssw3_kyK2q-KZ9MsaCF6mqfFLA/exec';
            
            const data = {
                timestamp: new Date().toISOString(),
                resultType: resultType,
                faithScore: scores.faith,
                reasonScore: scores.reason,
                mixedScore: scores.mixed,
                fateScore: scores.fate,
                totalQuestions: questions.length,
                answers: answers
            };

            try {
                const response = await fetch(scriptURL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });
                console.log('Results sent to Google Sheets successfully');
            } catch (error) {
                console.error('Error sending to Google Sheets:', error);
            }
        }

        function renderResult(scores, analysis) {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="result">
                    <h2>ğŸ‰ æµ‹éªŒç»“æœ</h2>
                    <div class="analysis">${analysis}</div>
                    <div class="scores">
                        <div class="score-item">
                            <div class="score-label">ä¿¡ä»°æˆåˆ†</div>
                            <div class="score-value">${scores.faith}</div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">ç†æ™ºæˆåˆ†</div>
                            <div class="score-value">${scores.reason}</div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">æŠ˜è¡·æˆåˆ†</div>
                            <div class="score-value">${scores.mixed}</div>
                        </div>
                        <div class="score-item">
                            <div class="score-label">å®¿å‘½æˆåˆ†</div>
                            <div class="score-value">${scores.fate}</div>
                        </div>
                    </div>
                    <button class="restart-btn" onclick="restart()">å†æµ‹ä¸€æ¬¡</button>
                </div>
            `;
        }

        function restart() {
            currentQuestion = 0;
            answers = [];
            renderQuestion();
        }

        // Initialize
        renderQuestion();
    </script>
</body>
</html>
